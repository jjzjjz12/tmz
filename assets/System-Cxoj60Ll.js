import{u as L}from"./useHttp-MdYmlePs.js";import{G as N,d as q,u as O,s as G,j as _,c as H,a as t,r as o,f as e,g as T,k as c,o as D,E as I,b as J,i as r,F as Q,t as E}from"./index-BDUm6mkv.js";function W(m){return N("/userAuth",{pageAuthority:m})}function X(m,s,i){return N("/setAuth",{btnList:m,pageList:s,account:i})}function M(m){return m.map(s=>{const i={label:s.name,url:s.url};return s.children&&(i.children=M(s.children)),i})}const Y={class:"dialog-footer"},Z=q({__name:"AuthModal",props:{dialogTableVisible:{type:Boolean,required:!0},checkedKeys:{type:Array,required:!0},checkBtn:{type:Array,required:!0},account:{type:String,required:!0}},emits:["close","reload"],setup(m,{emit:s}){const i=m,C=s,S=O(),{menu:g}=G(S),w=_(M(g.value)),V=_(),b=_([]),B=()=>{V.value.setCheckedKeys(i.checkedKeys),b.value=i.checkBtn},v=()=>{C("close")},U=async()=>{const y=await X(b.value,V.value.getCheckedKeys(!0),i.account);y.code===200&&I({message:y.message,type:"success"}),C("close"),C("reload")};return(y,u)=>{const x=o("el-tree"),z=o("el-card"),k=o("el-checkbox"),h=o("el-checkbox-group"),l=o("el-button"),f=o("el-dialog");return D(),H(f,{"model-value":m.dialogTableVisible,title:"权限设置",width:"800",onOpen:B,onClose:v},{footer:t(()=>[T("div",Y,[e(l,{onClick:v},{default:t(()=>u[3]||(u[3]=[c("取消")])),_:1}),e(l,{type:"primary",onClick:U},{default:t(()=>u[4]||(u[4]=[c(" 确认 ")])),_:1})])]),default:t(()=>[e(z,null,{header:t(()=>u[1]||(u[1]=[T("div",{class:"card-header"}," 页面标题 ",-1)])),default:t(()=>[e(x,{style:{"max-width":"600px"},data:w.value,ref_key:"treeRef",ref:V,"show-checkbox":"","node-key":"url"},null,8,["data"])]),_:1}),e(z,{class:"mt"},{header:t(()=>u[2]||(u[2]=[T("div",{class:"card-header"}," 按钮权限 ",-1)])),default:t(()=>[e(h,{modelValue:b.value,"onUpdate:modelValue":u[0]||(u[0]=n=>b.value=n)},{default:t(()=>[e(k,{label:"全部",value:"all"}),e(k,{label:"添加",value:"add"}),e(k,{label:"编辑",value:"edit"}),e(k,{label:"删除",value:"delete"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model-value"])}}}),ae=q({__name:"System",setup(m){const s=_({name:"",dep:""}),{dataList:i,loading:C,totals:S,pageInfo:g,loadData:w,handleSizeChange:V,handleCurrentChange:b,resetPagination:B}=L("/permissionList",s),v=_(!1);function U(h){const l=[];function f(n){n.url&&!n.children&&l.push(n.url),n.url&&n.children&&n.children.forEach(d=>{f(d)})}return h.forEach(n=>{f(n)}),l}const y=_([]),u=_([]),x=_("");function z(h,l){W(h).then(f=>{x.value=l;const{data:{list:n,btn:d}}=f;y.value=U(n),u.value=d,v.value=!0})}const k=()=>{s.value={name:"",dep:""},B()};return(h,l)=>{const f=o("el-input"),n=o("el-col"),d=o("el-option"),P=o("el-select"),A=o("el-button"),$=o("el-row"),K=o("el-card"),p=o("el-table-column"),R=o("el-tag"),j=o("el-table"),F=o("el-pagination");return D(),J(Q,null,[e(K,null,{default:t(()=>[e($,{gutter:20},{default:t(()=>[e(n,{span:6},{default:t(()=>[e(f,{modelValue:s.value.name,"onUpdate:modelValue":l[0]||(l[0]=a=>s.value.name=a),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),e(n,{span:6},{default:t(()=>[e(P,{modelValue:s.value.dep,"onUpdate:modelValue":l[1]||(l[1]=a=>s.value.dep=a),placeholder:"请选择部门"},{default:t(()=>[e(d,{label:"全部",value:""}),e(d,{label:"技术部",value:"技术部"}),e(d,{label:"市场部",value:"市场部"}),e(d,{label:"维修部",value:"维修部"}),e(d,{label:"运营部",value:"运营部"}),e(d,{label:"客服部",value:"客服部"})]),_:1},8,["modelValue"])]),_:1}),e(n,{span:6},{default:t(()=>[e(A,{type:"primary",size:"default",onClick:r(w)},{default:t(()=>l[7]||(l[7]=[c("查询")])),_:1},8,["onClick"]),e(A,{onClick:k},{default:t(()=>l[8]||(l[8]=[c("重置")])),_:1})]),_:1})]),_:1})]),_:1}),e(K,{class:"mt"},{default:t(()=>[e(j,{data:r(i),loading:r(C)},{default:t(()=>[e(p,{type:"index",width:"70",label:"序号"}),e(p,{label:"姓名",prop:"name"}),e(p,{label:"账号",prop:"account"}),e(p,{label:"电话",prop:"phone"}),e(p,{label:"身份证号",prop:"idNo"}),e(p,{label:"职位",prop:"position"},{default:t(a=>[e(R,{type:"primary"},{default:t(()=>[c(E(a.row.position),1)]),_:2},1024)]),_:1}),e(p,{label:"所属部门",prop:"department"}),e(p,{label:"页面权限",prop:"pageAuthority"},{default:t(a=>[e(R,{type:"success"},{default:t(()=>[c(E(a.row.pageAuthority),1)]),_:2},1024)]),_:1}),e(p,{label:"按钮权限",prop:"btnAuthority"},{default:t(a=>[e(R,{type:"info"},{default:t(()=>[c(E(a.row.position),1)]),_:2},1024)]),_:1}),e(p,{label:"操作"},{default:t(a=>[e(A,{type:"primary",size:"small",onClick:ee=>z(a.row.pageAuthority,a.row.account)},{default:t(()=>l[9]||(l[9]=[c("权限设置")])),_:2},1032,["onClick"]),e(A,{type:"danger",size:"small",onClick:l[2]||(l[2]=()=>{})},{default:t(()=>l[10]||(l[10]=[c("删除")])),_:1}),e(A,{type:"danger",size:"small",onClick:l[3]||(l[3]=()=>{})},{default:t(()=>l[11]||(l[11]=[c("禁用")])),_:1})]),_:1})]),_:1},8,["data","loading"]),e(F,{class:"fr mb mt","current-page":r(g).page,"onUpdate:currentPage":l[4]||(l[4]=a=>r(g).page=a),"page-size":r(g).pageSize,"onUpdate:pageSize":l[5]||(l[5]=a=>r(g).pageSize=a),"page-sizes":[10,20,30,40],layout:"sizes, prev, pager, next, jumper,total ",total:r(S),onSizeChange:r(V),onCurrentChange:r(b)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])]),_:1}),e(Z,{dialogTableVisible:v.value,"checked-keys":y.value,onClose:l[6]||(l[6]=a=>v.value=!1),"check-btn":u.value,account:x.value,onReload:r(w)},null,8,["dialogTableVisible","checked-keys","check-btn","account","onReload"])],64)}}});export{ae as default};
